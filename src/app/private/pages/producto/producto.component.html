<div class="bg-white p-4 sm:p-6 rounded-2xl shadow-md max-w-screen-xl mx-auto w-full overflow-hidden">
    <section>
        <h1 class="text-2xl font-bold text-gray-800">Productos</h1>
        <hr class="my-3 border-gray-300">
    </section>

    <div class="mt-5 grid grid-cols-1 sm:grid-cols-6 gap-4 items-end">
        <div class="sm:col-span-4">
            <form class="flex flex-col sm:flex-row gap-4" [formGroup]="formulario">
                <div class="w-full">
                    <label for="first-name" class="block text-sm font-medium text-gray-900">Nombre</label>
                    <input id="first-name" type="text" formControlName="nombre"
                        class="block w-full rounded-md px-3 py-2 text-base text-gray-900 placeholder:text-gray-400 border border-gray-300 focus:border-red-400 focus:ring focus:ring-red-300 focus:ring-opacity-50 sm:text-sm" />
                </div>
                <div class="w-full">
                    <label for="idCategoria" class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
                    <select formControlName="idCategoria" id="idCategoria"
                        class="w-full rounded-lg border border-gray-300 px-3 py-2 bg-white text-gray-900 focus:ring-2 focus:ring-red-400 focus:outline-none">
                        <option disabled selected value="0">Selecciona</option>
                        <option *ngFor="let categoria of categoriasMenu" [value]="categoria.id">
                            {{ categoria.nombre }}
                        </option>
                    </select>
                </div>
            </form>
        </div>

        <div class="sm:col-span-2 flex items-end">
            <button (click)="ObtenerProducto()"
                class="w-full sm:w-auto px-4 py-2 rounded-lg bg-red-700 text-white font-medium shadow hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-offset-1 transition">
                <i class="bi bi-search"></i>
            </button>
        </div>
    </div>

    <div class="mt-4 flex justify-end">
        <button (click)="abrirModalAgregarEditar()"
            class="w-full sm:w-auto px-4 py-2 rounded-lg bg-red-700 text-white font-medium shadow hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-offset-1 transition">
            <i class="bi bi-plus"></i> Agregar
        </button>
    </div>

    <div class="mt-6 overflow-x-auto rounded-lg shadow">
        <table class="min-w-full divide-y divide-gray-200 border border-gray-200">
            <thead class="bg-gray-100">
                <tr>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Nr.
                    </th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Id</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Nombre
                    </th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                        Descripción</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Precio
                    </th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Estado
                    </th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">
                        Categoría</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Usuario
                        Creación</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Fecha
                        Creación</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Usuario
                        Modificación</th>
                    <th class="px-4 py-3 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider">Fecha
                        Modificación</th>
                    <th class="px-4 py-3 text-center text-xs font-semibold text-gray-700 uppercase tracking-wider">
                        Acciones</th>
                </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
                <tr *ngFor="let producto of productos; let i = index" [ngClass]="{ 'bg-gray-50': i % 2 === 0 }">
                    <td class="px-4 py-4 text-sm text-gray-900">{{ i + 1 }}</td>
                    <td class="px-4 py-4 text-sm text-gray-900">{{ producto.id }}</td>
                    <td class="px-4 py-4 text-sm text-gray-900">{{ producto.nombre }}</td>
                    <td class="px-4 py-4 text-sm text-gray-900 truncate" title="{{ producto.descripcion }}">
                        {{ producto.descripcion | slice:0:30 }}<span *ngIf="producto.descripcion.length > 30">...</span>
                    </td>
                    <td class="px-4 py-4 text-sm text-gray-900">{{ producto.precio }}</td>
                    <td class="px-4 py-4 text-sm text-gray-900">{{ producto.estado }}</td>
                    <td class="px-4 py-4 text-sm text-gray-900">{{ producto.categoria }}</td>
                    <td class="px-4 py-4 text-sm text-gray-900">{{ producto.usuarioCrea }}</td>
                    <td class="px-4 py-4 text-sm text-gray-900">{{ producto.fechaCrea }}</td>
                    <td class="px-4 py-4 text-sm text-gray-900">{{ producto.usuarioModifica }}</td>
                    <td class="px-4 py-4 text-sm text-gray-900">{{ producto.fechaModifica }}</td>
                    <td class="px-4 py-4 text-center text-sm">
                        <div class="inline-flex rounded-md shadow-sm" role="group">
                            <button type="button" (click)="abrirModalAgregarEditar(producto.id)"
                                class="px-3 py-2 text-sm font-medium text-white bg-red-600 rounded-l-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-400">
                                <i class="bi bi-pencil-square"></i>
                            </button>
                            <button type="button" (click)="(producto.id)"
                                class="px-3 py-2 text-sm font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-400">
                                <i class="bi bi-menu-app"></i>
                            </button>
                            <button type="button" (click)="CambiarEstado(producto.id)" [ngClass]="{
                                    'bg-green-600 hover:bg-green-700 focus:ring-green-400': producto.estado === 'INACTIVO',
                                    'bg-red-600 hover:bg-red-700 focus:ring-red-400': producto.estado === 'ACTIVO'
                                    }" class="px-3 py-2 text-sm font-medium text-white rounded-r-lg focus:outline-none focus:ring-2">
                                <i *ngIf="producto.estado === 'ACTIVO'; else reciclar" class="bi bi-trash"></i>
                                <ng-template #reciclar>
                                    <i class="bi bi-arrow-clockwise"></i>
                                </ng-template>
                            </button>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>

        <app-paginacion [totalPages]="totalPaginas" [currentPage]="pagina" [total]="total"
            (pageChange)="Paginar($event)">
        </app-paginacion>
    </div>

    <app-agregar-editar-producto [isOpen]="modalAbiertoAgregarEditar" (close)="cerrarModalAgregarEditar()"
        [idProducto]="idProductoSeleccionado">
    </app-agregar-editar-producto>
</div>